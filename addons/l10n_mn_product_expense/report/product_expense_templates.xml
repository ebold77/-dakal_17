<?xml version="1.0" encoding="utf-8"?>
<odoo>
<!--    Шаардах хуудас хэвлэх загвар-->
    <template id="report_product_expense_document">
        <t t-call="web.external_layout">
            <t t-set="data_report_header_spacing" t-value="5"/>
            <t t-set="data_report_margin_top" t-value="5"/>
            <t t-foreach="docs" t-as="o">
                <div class="page l10n_mn_base_report">
                    <table style="width:100%;font-family: 'Arial';font-size: 13px;">
                        <tr>
                            <td style="width:35%;">
                                <span>
                                    <b>NHForm PR-6</b>
                                </span>
                            </td>
                            <td style="width:35%;"></td>
                            <td style="width:30%;">
                                <span>Annex to the Order No. 347 of the Minister of </span>
                                <span>Finance dated December 5, 2017</span>
                            </td>
                        </tr>
                    </table>
                    <br/>
                    <br/>
                    <table style="width:100%;">
                        <tr>
                            <td style="text-align: center;">
                                <h4>Product Expense №
                                    <b>
                                        <t t-esc="o.name"/>
                                    </b>
                                </h4>
                            </td>
                        </tr>
                    </table>

                    <table class="table-l10n_mn-header" style="margin-top: 20px;font-family: 'Arial';font-size: 13px;" width="100%; border-top: 2px;">
                        <tr style="width:100%;">
                            <td style="width:40%;text-align: left;font-family: 'Arial';font-size: 13px;">
                                <b>
                                    <span t-esc="o.company_id.name"></span>
                                </b>
                                <br/>
                                ...............................................................
                                <br/>
                                <span>(Company)</span>
                            </td>
                            <td style="width:40%;"></td>
                            <td style="width:20%;text-align: left;font-family: 'Arial';font-size: 13px;">
                                <span>Date:</span>
                                <b>
                                    <span t-esc="o.date"/>
                                </b>
                            </td>
                        </tr>
                    </table>
                    <table class="table-l10n_mn-header" style="margin-top: 20px;font-family: 'Arial';font-size: 13px;" width="100%; border-top: 2px;">
                        <tr style="width:100%; vertical-align:bottom;">
                            <td style="width:10%;"></td>
                            <td style="width:40%; text-align:center;font-family: 'Arial';font-size: 13px;">
                                <b>
                                    <span t-esc="o.warehouse_id.name"/>
                                </b>
                            </td>
                        </tr>
                        <tr style="width:100%;">
                            <td style="width:10%;font-family: 'Arial';font-size: 13px;">Warehouse</td>
                            <td style="width:40%;">
                                _________________________________________________________________
                            </td>
                            <td style="width:50%;">
                                _________________________________________________________________
                            </td>
                        </tr>
                        <tr style="width:100%;">
                            <td style="width:10%;"></td>
                            <td style="width:40%; text-align:center;font-family: 'Arial';font-size: 13px;">
                                <b>
                                    <t t-if="o.employee_id.name ">
                                        <span t-esc=" o.employee_id.name" />
                                    </t>
                                    <t t-if="o.employee_id.name ">
                                        <span t-esc="o.employee_id.name" />
                                    </t>
                                    <t t-if="o.employee_id.job_id.name">
                                        <span t-esc="o.employee_id.job_id.name" />
                                    </t>
                                </b>
                            </td>
                        </tr>
                        <tr style="width:100%;">
                            <td style="width:10%;font-family: 'Arial';font-size: 13px;">From</td>
                            <td style="width:40%;">
                                _________________________________________________________________
                            </td>
                            <td style="width:50%;">
                                _________________________________________________________________
                            </td>
                        </tr>
                        <tr style="width:100%;">
                            <td style="width:10%;font-family: 'Arial';font-size: 13px;"></td>
                            <td style="width:40%; text-align:center;">(name, job title)
                            </td>
                            <td style="width:40%;"></td>
                        </tr>
                        <tr style="width:100%;">
                            <td style="width:10%;"></td>
                            <td style="width:40%; text-align:center;font-family: 'Arial';font-size: 13px;">
                                <b>
                                    <span t-esc="o.department_id.name"/>
                                </b>
                            </td>
                        </tr>
                        <tr style="width:100%;">
                            <td style="width:10%;font-family: 'Arial';font-size: 13px;">Where</td>
                            <td style="width:40%;">
                                _________________________________________________________________
                            </td>
                            <td style="width:50%;">
                                _________________________________________________________________
                            </td>
                        </tr>
                        <tr style="width:100%;">
                            <td style="width:10%;"></td>
                            <td style="width:40%; text-align:center;font-family: 'Arial';font-size: 13px;">(department name)
                            </td>
                            <td style="width:50%;"></td>
                        </tr>
                        <tr style="width:100%; vertical-align:bottom;">
                            <td style="width:10%;"></td>
                            <td style="width:40%; text-align:center">
                                <b>
                                    <span t-esc="o.description"/>
                                </b>
                            </td>
                        </tr>
                        <tr style="width:100%;">
                            <td style="width:10%;font-family: 'Arial';font-size: 13px;">Purpose</td>
                            <td style="width:40%;">
                                _________________________________________________________________
                            </td>
                            <td style="width:50%;">
                                _________________________________________________________________
                            </td>
                        </tr>

                    </table>
                    <t t-set="count" t-value="1"/>
                    <div t-if="o.expense_line_ids">
                        <table border="1" class="table table-bordered table-l10n_mn-header" style="margin-top: 20px;font-family: 'Arial';font-size: 13px;" width="100%; border-top: 2px;">
                            <tr style="width:100%;" bgcolor="#cfeef9">
                                <th style="width:5%;" rowspan="2">№</th>
                                <th style="width:10%;" rowspan="2">Default Code</th>
                                <th style="width:20%;" rowspan="2">Product Name</th>
                                <th style="width:5%;" rowspan="2">Unit of Measure</th>
                                <th groups="l10n_mn_stock.group_stock_view_cost" style="width:5%;" rowspan="2">Cost</th>
                                <th style="width:30%; text-align:center" colspan="3">Quantity</th>
                                <th groups="l10n_mn_stock.group_stock_view_cost" style="width:5%;" rowspan="2">Total Amount</th>
                            </tr>
                            <tr style="width:100%;" bgcolor="#cfeef9">
                                <th style="width:15%; text-align:center">Employee</th>
                                <th style="width:15%; text-align:center">Approved</th>
                                <th style="width:15%; text-align:center">Given</th>
                            </tr>
                            <t t-foreach="o.expense_line_ids" t-as="exp">
                                <tr style="width:100%;">
                                    <td style="width:5%;" align="center" t-esc="count"></td>
                                    <td style="width:10%;">
                                        <b>
                                            <span t-esc="exp.product_id.product_tmpl_id.default_code"/>
                                        </b>
                                    </td>
                                    <td style="width:20%;">
                                        <b>
                                            <span t-esc="exp.product_id.product_tmpl_id.name"/>
                                        </b>
                                    </td>
                                    <td style="width:5%;">
                                        <b>
                                            <span t-esc="exp.product_id.product_tmpl_id.uom_id.name"/>
                                        </b>
                                    </td>
                                    <td groups="l10n_mn_stock.group_stock_view_cost" style="width:5%;">
                                        <b>
                                            <span t-esc="exp.standard_price"/>
                                        </b>
                                    </td>

                                    <td style="width:15%;">
                                        <b>
                                            <span t-esc="exp.quantity"/>
                                        </b>
                                    </td>
                                    <td style="width:15%;">
                                        <b>
                                            <span t-esc="exp.quantity"/>
                                        </b>
                                    </td>
                                    <td style="width:15%;">
                                        <b>
                                            <span t-esc="exp.quantity"/>
                                        </b>
                                    </td>
                                    <td groups="l10n_mn_stock.group_stock_view_cost" style="width:10%;">
                                        <b>
                                            <span t-esc="'{0:,.2f}'.format(exp.price_subtotal)"/>
                                        </b>
                                    </td>
                                    <t t-set="count" t-value="count+1"/>
                                </tr>
                            </t>
                        </table>
                    </div>
                    <div groups="l10n_mn_stock.group_stock_view_cost"
                    style="float: right"><b>Total Amount: <span t-esc="'{0:,.2f}'.format(o.total_amount)"/></b></div>
                    <div t-if="o.history_line_ids and o.state in ('done', 'approved')">
                        <table border="1" class="table table-bordered table-l10n_mn-header" style="margin-top: 20px;font-family: 'Arial';font-size: 13px;" width="100%; border-top: 2px;" t-if="o.history_line_ids and o.state in ('done', 'approved')">
                            <tr bgcolor="#cfeef9">
                                <th>№</th>
                                <th>Workflow Step</th>
                                <th>Sent Date</th>
                                <th>Validator</th>
                                <th>Action Date</th>
                                <th>Action</th>
                            </tr>
                            <t t-foreach="o.history_line_ids" t-as="line">
                                <tr>
                                    <td style="text-align: center">
                                        <b>
                                            <span t-esc="line.line_sequence"/>
                                        </b>
                                    </td>
                                    <td style="text-align: center">
                                        <b>
                                            <span t-esc="line.name"/>
                                        </b>
                                    </td>
                                    <td style="text-align: center">
                                        <b>
                                            <span t-esc="line.sent_date"/>
                                        </b>
                                    </td>
                                    <td style="text-align: center">
                                        <b>
                                            <span t-esc="line.user_id.name"/>
                                        </b>
                                    </td>
                                    <td style="text-align: center">
                                        <b>
                                            <span t-esc="line.action_date"/>
                                        </b>
                                    </td>
                                    <td style="text-align: center">
                                        <b>
                                            <t t-if="line.action">
                                                <span t-esc="dict(line.fields_get(allfields=['action'])['action']['selection'])[line.action]"/>
                                            </t>
                                        </b>
                                    </td>
                                </tr>
                            </t>
                        </table>
                    </div>
                    <table style="margin-top: 20px; font-family: 'Arial';font-size: 13px;" width="100%;">
                        <tbody t-foreach="signature_lines[o.id]" t-as="l" id="signature_lines_tbody" >
                            <tr width="100%; border-top: 2px;">
                                <td t-if="l['name']" style="width:50%; text-align:left" >
                                    <br/>
                                    <span t-esc="l['name']" />:
                                    <img t-if="l['signature']" t-att-src="image_data_uri(l['signature'])"  width="150" height="25"/>
                                    <span t-else=" "> ..........................  </span>
                                    <span> / <span t-if="l['partner']" t-esc="l['partner']"/> <span t-else=" ">.......................... </span>/ </span>
                                </td>
                            </tr>
                        </tbody>
                        <tr style="width:100%;">
                            <td style="width:60%; text-align:left;padding-top:20px">Product Expense Created:                                            <b>
                                </b> ..............................
                                 /<span t-esc="o.create_uid.name"/>/
                            </td>
                        </tr>
                    </table>
                </div>
            </t>
        </t>
    </template>

	<template id="report_product_expense">
		<t t-call="web.html_container">
            <t t-call="l10n_mn_product_expense.report_product_expense_document" />
		</t>
	</template>
</odoo>
